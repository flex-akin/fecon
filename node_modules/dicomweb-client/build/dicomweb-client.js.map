{"version":3,"file":"dicomweb-client.js","sources":["../src/message.js","../src/api.js","../src/utils.js","../src/version.js","../src/dicomweb-client.js"],"sourcesContent":["/**\n * Converts a Uint8Array to a String.\n * @param {Uint8Array} array that should be converted\n * @param {Number} offset array offset in case only subset of array items should\n                   be extracted (default: 0)\n * @param {Number} limit maximum number of array items that should be extracted\n                   (defaults to length of array)\n * @returns {String}\n */\nfunction uint8ArrayToString(arr, offset = 0, limit) {\n  const itemLimit = limit || arr.length - offset;\n  let str = \"\";\n  for (let i = offset; i < offset + itemLimit; i++) {\n    str += String.fromCharCode(arr[i]);\n  }\n  return str;\n}\n\n/**\n * Converts a String to a Uint8Array.\n * @param {String} str string that should be converted\n * @returns {Uint8Array}\n */\nfunction stringToUint8Array(str) {\n  const arr = new Uint8Array(str.length);\n  for (let i = 0, j = str.length; i < j; i++) {\n    arr[i] = str.charCodeAt(i);\n  }\n  return arr;\n}\n\n/**\n * Identifies the boundary in a multipart/related message header.\n * @param {String} header message header\n * @returns {String} boundary\n */\nfunction identifyBoundary(header) {\n  const parts = header.split(\"\\r\\n\");\n\n  for (let i = 0; i < parts.length; i++) {\n    if (parts[i].substr(0, 2) === \"--\") {\n      return parts[i];\n    }\n  }\n\n  return null;\n}\n\n/**\n * Checks whether a given token is contained by a message at a given offset.\n * @param {Uint8Array} message message content\n * @param {Uint8Array} token substring that should be present\n * @param {Number} offset offset in message content from where search should start\n * @returns {Boolean} whether message contains token at offset\n */\nfunction containsToken(message, token, offset = 0) {\n  if (offset + token.length > message.length) {\n    return false;\n  }\n\n  let index = offset;\n  for (let i = 0; i < token.length; i++) {\n    if (token[i] !== message[index]) {\n      return false;\n    }\n\n    index += 1;\n  }\n  return true;\n}\n\n/**\n * Finds a given token in a message at a given offset.\n * @param {Uint8Array} message message content\n * @param {Uint8Array} token substring that should be found\n * @param {String} offset message body offset from where search should start\n * @returns {Boolean} whether message has a part at given offset or not\n */\nfunction findToken(message, token, offset = 0, maxSearchLength) {\n  let searchLength = message.length;\n  if (maxSearchLength) {\n    searchLength = Math.min(offset + maxSearchLength, message.length);\n  }\n\n  for (let i = offset; i < searchLength; i++) {\n    // If the first value of the message matches\n    // the first value of the token, check if\n    // this is the full token.\n    if (message[i] === token[0]) {\n      if (containsToken(message, token, i)) {\n        return i;\n      }\n    }\n  }\n\n  return -1;\n}\n\n/**\n * Create a random GUID\n *\n * @return {string}\n */\nfunction guid() {\n  function s4() {\n    return Math.floor((1 + Math.random()) * 0x10000)\n      .toString(16)\n      .substring(1);\n  }\n  return `${s4() + s4()}-${s4()}-${s4()}-${s4()}-${s4()}${s4()}${s4()}`;\n}\n\n/**\n * @typedef {Object} MultipartEncodedData\n * @property {ArrayBuffer} data The encoded Multipart Data\n * @property {String} boundary The boundary used to divide pieces of the encoded data\n */\n\n/**\n * Encode one or more DICOM datasets into a single body so it can be\n * sent using the Multipart Content-Type.\n *\n * @param {ArrayBuffer[]} datasets Array containing each file to be encoded in the\n                          multipart body, passed as ArrayBuffers.\n * @param {String} [boundary] Optional string to define a boundary between each part\n                              of the multipart body. If this is not specified, a random\n                              GUID will be generated.\n * @return {MultipartEncodedData} The Multipart encoded data returned as an Object. This\n                                  contains both the data itself, and the boundary string\n                                  used to divide it.\n */\nfunction multipartEncode(\n  datasets,\n  boundary = guid(),\n  contentType = \"application/dicom\"\n) {\n  const contentTypeString = `Content-Type: ${contentType}`;\n  const header = `\\r\\n--${boundary}\\r\\n${contentTypeString}\\r\\n\\r\\n`;\n  const footer = `\\r\\n--${boundary}--`;\n  const headerArray = stringToUint8Array(header);\n  const footerArray = stringToUint8Array(footer);\n  const headerLength = headerArray.length;\n  const footerLength = footerArray.length;\n\n  let length = 0;\n\n  // Calculate the total length for the final array\n  const contentArrays = datasets.map(datasetBuffer => {\n    const contentArray = new Uint8Array(datasetBuffer);\n    const contentLength = contentArray.length;\n\n    length += headerLength + contentLength + footerLength;\n\n    return contentArray;\n  });\n\n  // Allocate the array\n  const multipartArray = new Uint8Array(length);\n\n  // Set the initial header\n  multipartArray.set(headerArray, 0);\n\n  // Write each dataset into the multipart array\n  let position = 0;\n  contentArrays.forEach(contentArray => {\n    multipartArray.set(headerArray, position);\n    multipartArray.set(contentArray, position + headerLength);\n\n    position += headerLength + contentArray.length;\n  });\n\n  multipartArray.set(footerArray, position);\n\n  return {\n    data: multipartArray.buffer,\n    boundary\n  };\n}\n\n/**\n * Decode a Multipart encoded ArrayBuffer and return the components as an Array.\n *\n * @param {ArrayBuffer} response Data encoded as a 'multipart/related' message\n * @returns {Array} The content\n */\nfunction multipartDecode(response) {\n  const message = new Uint8Array(response);\n\n  /* Set a maximum length to search for the header boundaries, otherwise\n       findToken can run for a long time\n    */\n  const maxSearchLength = 1000;\n\n  // First look for the multipart mime header\n  const separator = stringToUint8Array(\"\\r\\n\\r\\n\");\n  const headerIndex = findToken(message, separator, 0, maxSearchLength);\n  if (headerIndex === -1) {\n    throw new Error(\"Response message has no multipart mime header\");\n  }\n\n  const header = uint8ArrayToString(message, 0, headerIndex);\n  const boundaryString = identifyBoundary(header);\n  if (!boundaryString) {\n    throw new Error(\"Header of response message does not specify boundary\");\n  }\n\n  const boundary = stringToUint8Array(boundaryString);\n  const boundaryLength = boundary.length;\n  const components = [];\n\n  let offset = boundaryLength;\n\n  // Loop until we cannot find any more boundaries\n  let boundaryIndex;\n\n  while (boundaryIndex !== -1) {\n    // Search for the next boundary in the message, starting\n    // from the current offset position\n    boundaryIndex = findToken(message, boundary, offset);\n\n    // If no further boundaries are found, stop here.\n    if (boundaryIndex === -1) {\n      break;\n    }\n\n    const headerTokenIndex = findToken(\n      message,\n      separator,\n      offset,\n      maxSearchLength\n    );\n    if (headerTokenIndex === -1) {\n      throw new Error(\"Response message part has no mime header\");\n    }\n    offset = headerTokenIndex + separator.length;\n\n    // Extract data from response message, excluding \"\\r\\n\"\n    const spacingLength = 2;\n    const data = response.slice(offset, boundaryIndex - spacingLength);\n\n    // Add the data to the array of results\n    components.push(data);\n\n    // Move the offset to the end of the current section,\n    // plus the identified boundary\n    offset = boundaryIndex + boundaryLength;\n  }\n\n  return components;\n}\n\nexport {\n  containsToken,\n  findToken,\n  identifyBoundary,\n  uint8ArrayToString,\n  stringToUint8Array,\n  multipartEncode,\n  multipartDecode,\n  guid\n};\n","import { multipartEncode, multipartDecode } from \"./message.js\";\n\nfunction isObject(obj) {\n  return typeof obj === \"object\" && obj !== null;\n}\n\nfunction isEmptyObject(obj) {\n  return Object.keys(obj).length === 0 && obj.constructor === Object;\n}\n\nfunction areValidRequestHooks(requestHooks) {\n  const isValid = Array.isArray(requestHooks) && requestHooks.every(requestHook => \n    typeof requestHook === 'function'\n      && requestHook.length === 2\n  );\n\n  if (!isValid) {\n    console.warn(\n      'Request hooks should have the following signature: ' +\n      'function requestHook(request, metadata) { return request; }'\n    );\n  }\n\n  return isValid;\n}\n\nconst getFirstResult = result => result[0];\nconst getFirstResultIfLengthGtOne = result => {\n  if (result.length > 1) {\n    return result;\n  }\n\n  return result[0]\n};\n\nconst MEDIATYPES = {\n  DICOM: \"application/dicom\",\n  DICOM_JSON: \"application/dicom+json\",\n  OCTET_STREAM: \"application/octet-stream\",\n  PDF: \"application/pdf\",\n  JPEG: \"image/jpeg\",\n  PNG: \"image/png\"\n};\n\n/**\n * A callback with the request instance and metadata information\n * of the currently request being executed that should necessarily\n * return the given request optionally modified.\n * @typedef {function} RequestHook\n * @param {XMLHttpRequest} request - The original XMLHttpRequest instance.\n * @param {object} metadata - The metadata used by the request.\n */\n\n/**\n * Class for interacting with DICOMweb RESTful services.\n */\nclass DICOMwebClient {\n  /**\n   * @constructor\n   * @param {Object} options\n   * @param {String} options.url - URL of the DICOMweb RESTful Service endpoint\n   * @param {String} options.qidoURLPrefix - URL path prefix for QIDO-RS\n   * @param {String} options.wadoURLPrefix - URL path prefix for WADO-RS\n   * @param {String} options.stowURLPrefix - URL path prefix for STOW-RS\n   * @param {String} options.username - Username\n   * @param {String} options.password - Password\n   * @param {Object} options.headers - HTTP headers\n   * @param {Array.<RequestHook>} options.requestHooks - Request hooks.\n   * @param {Object} options.verbose - print to console request warnings and errors, default true\n   */\n  constructor(options) {\n    this.baseURL = options.url;\n    if (!this.baseURL) {\n      console.error(\"no DICOMweb base url provided - calls will fail\");\n    }\n\n    if (\"username\" in options) {\n      this.username = options.username;\n      if (!(\"password\" in options)) {\n        console.error(\n          \"no password provided to authenticate with DICOMweb service\"\n        );\n      }\n      this.password = options.password;\n    }\n\n    if (\"qidoURLPrefix\" in options) {\n      console.log(`use URL prefix for QIDO-RS: ${options.qidoURLPrefix}`);\n      this.qidoURL = `${this.baseURL}/${options.qidoURLPrefix}`;\n    } else {\n      this.qidoURL = this.baseURL;\n    }\n\n    if (\"wadoURLPrefix\" in options) {\n      console.log(`use URL prefix for WADO-RS: ${options.wadoURLPrefix}`);\n      this.wadoURL = `${this.baseURL}/${options.wadoURLPrefix}`;\n    } else {\n      this.wadoURL = this.baseURL;\n    }\n\n    if (\"stowURLPrefix\" in options) {\n      console.log(`use URL prefix for STOW-RS: ${options.stowURLPrefix}`);\n      this.stowURL = `${this.baseURL}/${options.stowURLPrefix}`;\n    } else {\n      this.stowURL = this.baseURL;\n    }\n\n    if (\"requestHooks\" in options) {\n      this.requestHooks = options.requestHooks;\n    }\n\n    // Headers to pass to requests.\n    this.headers = options.headers || {};\n\n    // Optional error interceptor callback to handle any failed request.\n    this.errorInterceptor = options.errorInterceptor || function() {};\n\n    // Verbose - print to console request warnings and errors, default true\n    this.verbose = options.verbose === false ? false : true;\n  }\n\n  /**\n   * Sets verbose flag.\n   *\n   * @param {Boolean} verbose\n   */\n  setVerbose(verbose) {\n    this.verbose = verbose\n  }\n\n  /**\n   * Gets verbose flag.\n   *\n   * @return {Boolean} verbose\n   */\n  getVerbose() {\n    return this.verbose;\n  }\n\n  static _parseQueryParameters(params = {}) {\n    let queryString = \"?\";\n    Object.keys(params).forEach((key, index) => {\n      if (index !== 0) {\n        queryString += \"&\";\n      }\n      queryString += `${key}=${encodeURIComponent(params[key])}`;\n    });\n    return queryString;\n  }\n\n  /**\n   * Performs an HTTP request.\n   *\n   * @param {String} url\n   * @param {String} method\n   * @param {Object} headers\n   * @param {Object} options\n   * @param {Array.<RequestHook>} options.requestHooks - Request hooks.\n   * @return {*}\n   * @private\n   */\n  _httpRequest(url, method, headers = {}, options = {}) {\n\n    const { errorInterceptor, requestHooks } = this;\n\n    return new Promise((resolve, reject) => {\n      let request = new XMLHttpRequest();\n\n      request.open(method, url, true);\n      if (\"responseType\" in options) {\n        request.responseType = options.responseType;\n      }\n\n      if (typeof headers === \"object\") {\n        Object.keys(headers).forEach(key => {\n          request.setRequestHeader(key, headers[key]);\n        });\n      }\n\n      // now add custom headers from the user\n      // (e.g. access tokens)\n      const userHeaders = this.headers;\n      Object.keys(userHeaders).forEach(key => {\n        request.setRequestHeader(key, userHeaders[key]);\n      });\n\n      // Event triggered when upload starts\n      request.onloadstart = function onloadstart() {\n        // console.log('upload started: ', url)\n      };\n\n      // Event triggered when upload ends\n      request.onloadend = function onloadend() {\n        // console.log('upload finished')\n      };\n\n      // Handle response message\n      request.onreadystatechange = () => {\n        if (request.readyState === 4) {\n          if (request.status === 200) {\n            resolve(request.response);\n          } else if (request.status === 202) {\n            if (this.verbose) {\n              console.warn(\"some resources already existed: \", request);\n            }\n            resolve(request.response);\n          } else if (request.status === 204) {\n            if (this.verbose) {\n              console.warn(\"empty response for request: \", request);\n            }\n            resolve([]);\n          } else {\n            const error = new Error(\"request failed\");\n            error.request = request;\n            error.response = request.response;\n            error.status = request.status;\n            if (this.verbose) {\n              console.error(\"request failed: \", request);\n              console.error(error);\n              console.error(error.response);\n            }\n\n            errorInterceptor(error);\n\n            reject(error);\n          }\n        }\n      };\n\n      // Event triggered while download progresses\n      if (\"progressCallback\" in options) {\n        if (typeof options.progressCallback === \"function\") {\n          request.onprogress = options.progressCallback;\n        }\n      }\n\n      if (requestHooks && areValidRequestHooks(requestHooks)) { \n        const headers = Object.assign({}, headers, this.headers);\n        const metadata = { method, url, headers };\n        const pipeRequestHooks = functions => (args) => functions.reduce((args, fn) => fn(args, metadata), args);\n        const pipedRequest = pipeRequestHooks(requestHooks);\n        request = pipedRequest(request);\n      }\n\n      // Add withCredentials to request if needed\n      if (\"withCredentials\" in options) {\n        if (options.withCredentials) {\n          request.withCredentials = true;\n        }\n      }\n\n      if (\"data\" in options) {\n        request.send(options.data);\n      } else {\n        request.send();\n      }\n    });\n  }\n\n  /**\n   * Performs an HTTP GET request.\n   *\n   * @param {String} url\n   * @param {Object} headers\n   * @param {Object} responseType\n   * @param {Function} progressCallback\n   * @return {*}\n   * @private\n   */\n  _httpGet(url, headers, responseType, progressCallback, withCredentials) {\n    return this._httpRequest(url, \"get\", headers, {\n      responseType,\n      progressCallback,\n      withCredentials\n    });\n  }\n\n  /**\n   * Performs an HTTP GET request that accepts a message with application/json\n   * media type.\n   *\n   * @param {String} url\n   * @param {Object} params\n   * @param {Function} progressCallback\n   * @return {*}\n   * @private\n   */\n  _httpGetApplicationJson(url, params = {}, progressCallback, withCredentials) {\n    let urlWithQueryParams = url;\n\n    if (typeof params === \"object\") {\n      if (!isEmptyObject(params)) {\n        urlWithQueryParams += DICOMwebClient._parseQueryParameters(params);\n      }\n    }\n    const headers = { Accept: MEDIATYPES.DICOM_JSON };\n    const responseType = \"json\";\n    return this._httpGet(\n      urlWithQueryParams,\n      headers,\n      responseType,\n      progressCallback,\n      withCredentials\n    );\n  }\n\n  /**\n   * Performs an HTTP GET request that accepts a message with application/pdf\n   * media type.\n   *\n   * @param {String} url\n   * @param {Object} params\n   * @param {Function} progressCallback\n   * @return {*}\n   * @private\n   */\n  _httpGetApplicationPdf(url, params = {}, progressCallback, withCredentials) {\n    let urlWithQueryParams = url;\n\n    if (typeof params === \"object\") {\n      if (!isEmptyObject(params)) {\n        urlWithQueryParams += DICOMwebClient._parseQueryParameters(params);\n      }\n    }\n    const headers = { Accept: MEDIATYPES.PDF };\n    const responseType = \"json\";\n    return this._httpGet(\n      urlWithQueryParams,\n      headers,\n      responseType,\n      progressCallback,\n      withCredentials\n    );\n  }\n\n  /**\n   * Performs an HTTP GET request that accepts a message with an image\n   media type.\n   *\n   * @param {String} url\n   * @param {Object[]} mediaTypes\n   * @param {Object} params\n   * @param {Function} progressCallback\n   * @return {*}\n   * @private\n   */\n  _httpGetImage(url, mediaTypes, params = {}, progressCallback, withCredentials) {\n    let urlWithQueryParams = url;\n\n    if (typeof params === \"object\") {\n      if (!isEmptyObject(params)) {\n        urlWithQueryParams += DICOMwebClient._parseQueryParameters(params);\n      }\n    }\n\n    const supportedMediaTypes = [\n      \"image/\",\n      \"image/*\",\n      \"image/jpeg\",\n      \"image/jp2\",\n      \"image/gif\",\n      \"image/png\"\n    ];\n\n    const acceptHeaderFieldValue = DICOMwebClient._buildAcceptHeaderFieldValue(\n      mediaTypes,\n      supportedMediaTypes\n    );\n    const headers = { Accept: acceptHeaderFieldValue };\n    const responseType = \"arraybuffer\";\n    return this._httpGet(\n      urlWithQueryParams,\n      headers,\n      responseType,\n      progressCallback,\n      withCredentials\n    );\n  }\n\n  /**\n   * Performs an HTTP GET request that accepts a message with a text\n   media type.\n   *\n   * @param {String} url\n   * @param {Object[]} mediaTypes\n   * @param {Object} params\n   * @param {Function} progressCallback\n   * @return {*}\n   * @private\n   */\n  _httpGetText(url, mediaTypes, params = {}, progressCallback, withCredentials) {\n    let urlWithQueryParams = url;\n\n    if (typeof params === \"object\") {\n      if (!isEmptyObject(params)) {\n        urlWithQueryParams += DICOMwebClient._parseQueryParameters(params);\n      }\n    }\n\n    const supportedMediaTypes = [\n      \"text/\",\n      \"text/*\",\n      \"text/html\",\n      \"text/plain\",\n      \"text/rtf\",\n      \"text/xml\"\n    ];\n\n    const acceptHeaderFieldValue = DICOMwebClient._buildAcceptHeaderFieldValue(\n      mediaTypes,\n      supportedMediaTypes\n    );\n    const headers = { Accept: acceptHeaderFieldValue };\n    const responseType = \"arraybuffer\";\n    return this._httpGet(\n      urlWithQueryParams,\n      headers,\n      responseType,\n      progressCallback,\n      withCredentials\n    );\n  }\n\n  /**\n   * Performs an HTTP GET request that accepts a message with a video\n   media type.\n   *\n   * @param {String} url\n   * @param {Object[]} mediaTypes\n   * @param {Object} params\n   * @param {Function} progressCallback\n   * @return {*}\n   * @private\n   */\n  _httpGetVideo(url, mediaTypes, params = {}, progressCallback, withCredentials) {\n    let urlWithQueryParams = url;\n\n    if (typeof params === \"object\") {\n      if (!isEmptyObject(params)) {\n        urlWithQueryParams += DICOMwebClient._parseQueryParameters(params);\n      }\n    }\n\n    const supportedMediaTypes = [\n      \"video/\",\n      \"video/*\",\n      \"video/mpeg\",\n      \"video/mp4\",\n      \"video/H265\"\n    ];\n\n    const acceptHeaderFieldValue = DICOMwebClient._buildAcceptHeaderFieldValue(\n      mediaTypes,\n      supportedMediaTypes\n    );\n    const headers = { Accept: acceptHeaderFieldValue };\n    const responseType = \"arraybuffer\";\n    return this._httpGet(\n      urlWithQueryParams,\n      headers,\n      responseType,\n      progressCallback,\n      withCredentials\n    );\n  }\n\n  /**\n   * Asserts that a given media type is valid.\n   *\n   * @params {String} mediaType media type\n   */\n  static _assertMediaTypeIsValid(mediaType) {\n    if (!mediaType) {\n      throw new Error(`Not a valid media type: ${mediaType}`);\n    }\n\n    const sepIndex = mediaType.indexOf(\"/\");\n    if (sepIndex === -1) {\n      throw new Error(`Not a valid media type: ${mediaType}`);\n    }\n\n    const mediaTypeType = mediaType.slice(0, sepIndex);\n    const types = [\"application\", \"image\", \"text\", \"video\"];\n    if (!types.includes(mediaTypeType)) {\n      throw new Error(`Not a valid media type: ${mediaType}`);\n    }\n\n    if (mediaType.slice(sepIndex + 1).includes(\"/\")) {\n      throw new Error(`Not a valid media type: ${mediaType}`);\n    }\n  }\n\n  /**\n   * Performs an HTTP GET request that accepts a multipart message with an image media type.\n   *\n   * @param {String} url - Unique resource locator\n   * @param {Object[]} mediaTypes - Acceptable media types and optionally the UIDs of the\n   corresponding transfer syntaxes\n   * @param {Array} byteRange - Start and end of byte range\n   * @param {Object} params - Additional HTTP GET query parameters\n   * @param {Boolean} rendered - Whether resource should be requested using rendered media types\n   * @param {Function} progressCallback\n   * @private\n   * @returns {Promise<Array>} Content of HTTP message body parts\n   */\n  _httpGetMultipartImage(\n    url,\n    mediaTypes,\n    byteRange,\n    params,\n    rendered = false,\n    progressCallback,\n    withCredentials\n  ) {\n    const headers = {};\n    let supportedMediaTypes;\n    if (rendered) {\n      supportedMediaTypes = [\n        \"image/jpeg\",\n        \"image/gif\",\n        \"image/png\",\n        \"image/jp2\"\n      ];\n    } else {\n      supportedMediaTypes = {\n        \"1.2.840.10008.1.2.5\": [\"image/x-dicom-rle\"],\n        \"1.2.840.10008.1.2.4.50\": [\"image/jpeg\"],\n        \"1.2.840.10008.1.2.4.51\": [\"image/jpeg\"],\n        \"1.2.840.10008.1.2.4.57\": [\"image/jpeg\"],\n        \"1.2.840.10008.1.2.4.70\": [\"image/jpeg\"],\n        \"1.2.840.10008.1.2.4.80\": [\"image/x-jls\", \"image/jls\"],\n        \"1.2.840.10008.1.2.4.81\": [\"image/x-jls\", \"image/jls\"],\n        \"1.2.840.10008.1.2.4.90\": [\"image/jp2\"],\n        \"1.2.840.10008.1.2.4.91\": [\"image/jp2\"],\n        \"1.2.840.10008.1.2.4.92\": [\"image/jpx\"],\n        \"1.2.840.10008.1.2.4.93\": [\"image/jpx\"]\n      };\n\n      if (byteRange) {\n        headers.Range = DICOMwebClient._buildRangeHeaderFieldValue(byteRange);\n      }\n    }\n\n    headers.Accept = DICOMwebClient._buildMultipartAcceptHeaderFieldValue(\n      mediaTypes,\n      supportedMediaTypes\n    );\n\n    return this._httpGet(url, headers, \"arraybuffer\", progressCallback, withCredentials).then(\n      multipartDecode\n    );\n  }\n\n  /**\n   * Performs an HTTP GET request that accepts a multipart message with a video media type.\n   *\n   * @param {String} url - Unique resource locator\n   * @param {Object[]} mediaTypes - Acceptable media types and optionally the UIDs of the\n   corresponding transfer syntaxes\n   * @param {Array} byteRange - Start and end of byte range\n   * @param {Object} params - Additional HTTP GET query parameters\n   * @param {Boolean} rendered - Whether resource should be requested using rendered media types\n   * @param {Function} progressCallback\n   * @private\n   * @returns {Promise<Array>} Content of HTTP message body parts\n   */\n  _httpGetMultipartVideo(\n    url,\n    mediaTypes,\n    byteRange,\n    params,\n    rendered = false,\n    progressCallback,\n    withCredentials\n  ) {\n    const headers = {};\n    let supportedMediaTypes;\n    if (rendered) {\n      supportedMediaTypes = [\n        \"video/\",\n        \"video/*\",\n        \"video/mpeg2\",\n        \"video/mp4\",\n        \"video/H265\"\n      ];\n    } else {\n      supportedMediaTypes = {\n        \"1.2.840.10008.1.2.4.100\": [\"video/mpeg2\"],\n        \"1.2.840.10008.1.2.4.101\": [\"video/mpeg2\"],\n        \"1.2.840.10008.1.2.4.102\": [\"video/mp4\"],\n        \"1.2.840.10008.1.2.4.103\": [\"video/mp4\"],\n        \"1.2.840.10008.1.2.4.104\": [\"video/mp4\"],\n        \"1.2.840.10008.1.2.4.105\": [\"video/mp4\"],\n        \"1.2.840.10008.1.2.4.106\": [\"video/mp4\"]\n      };\n\n      if (byteRange) {\n        headers.Range = DICOMwebClient._buildRangeHeaderFieldValue(byteRange);\n      }\n    }\n\n    headers.Accept = DICOMwebClient._buildMultipartAcceptHeaderFieldValue(\n      mediaTypes,\n      supportedMediaTypes\n    );\n\n    return this._httpGet(url, headers, \"arraybuffer\", progressCallback, withCredentials).then(\n      multipartDecode\n    );\n  }\n\n  /**\n   * Performs an HTTP GET request that accepts a multipart message with a application/dicom media type.\n   *\n   * @param {String} url - Unique resource locator\n   * @param {Object[]} mediaTypes - Acceptable media types and optionally the UIDs of the\n   corresponding transfer syntaxes\n   * @param {Object} params - Additional HTTP GET query parameters\n   * @param {Function} progressCallback\n   * @private\n   * @returns {Promise<Array>} Content of HTTP message body parts\n   */\n  _httpGetMultipartApplicationDicom(url, mediaTypes, params, progressCallback, withCredentials) {\n    const headers = {};\n    const defaultMediaType = \"application/dicom\";\n    const supportedMediaTypes = {\n      \"1.2.840.10008.1.2.1\": [defaultMediaType],\n      \"1.2.840.10008.1.2.5\": [defaultMediaType],\n      \"1.2.840.10008.1.2.4.50\": [defaultMediaType],\n      \"1.2.840.10008.1.2.4.51\": [defaultMediaType],\n      \"1.2.840.10008.1.2.4.57\": [defaultMediaType],\n      \"1.2.840.10008.1.2.4.70\": [defaultMediaType],\n      \"1.2.840.10008.1.2.4.80\": [defaultMediaType],\n      \"1.2.840.10008.1.2.4.81\": [defaultMediaType],\n      \"1.2.840.10008.1.2.4.90\": [defaultMediaType],\n      \"1.2.840.10008.1.2.4.91\": [defaultMediaType],\n      \"1.2.840.10008.1.2.4.92\": [defaultMediaType],\n      \"1.2.840.10008.1.2.4.93\": [defaultMediaType],\n      \"1.2.840.10008.1.2.4.100\": [defaultMediaType],\n      \"1.2.840.10008.1.2.4.101\": [defaultMediaType],\n      \"1.2.840.10008.1.2.4.102\": [defaultMediaType],\n      \"1.2.840.10008.1.2.4.103\": [defaultMediaType],\n      \"1.2.840.10008.1.2.4.104\": [defaultMediaType],\n      \"1.2.840.10008.1.2.4.105\": [defaultMediaType],\n      \"1.2.840.10008.1.2.4.106\": [defaultMediaType]\n    };\n\n    let acceptableMediaTypes = mediaTypes;\n    if (!mediaTypes) {\n      acceptableMediaTypes = [{ mediaType: defaultMediaType }];\n    }\n\n    headers.Accept = DICOMwebClient._buildMultipartAcceptHeaderFieldValue(\n      acceptableMediaTypes,\n      supportedMediaTypes\n    );\n\n    return this._httpGet(url, headers, \"arraybuffer\", progressCallback, withCredentials).then(\n      multipartDecode\n    );\n  }\n\n  /**\n   * Performs an HTTP GET request that accepts a multipart message with a application/octet-stream media type.\n   *\n   * @param {String} url - Unique resource locator\n   * @param {Object[]} mediaTypes - Acceptable media types and optionally the UIDs of the\n   corresponding transfer syntaxes\n   * @param {Array} byteRange start and end of byte range\n   * @param {Object} params - Additional HTTP GET query parameters\n   * @param {Function} progressCallback\n   * @private\n   * @returns {Promise<Array>} Content of HTTP message body parts\n   */\n  _httpGetMultipartApplicationOctetStream(\n    url,\n    mediaTypes,\n    byteRange,\n    params,\n    progressCallback,\n    withCredentials\n  ) {\n    const headers = {};\n    const defaultMediaType = \"application/octet-stream\";\n    const supportedMediaTypes = {\n      \"1.2.840.10008.1.2.1\": [defaultMediaType]\n    };\n\n    let acceptableMediaTypes = mediaTypes;\n    if (!mediaTypes) {\n      acceptableMediaTypes = [{ mediaType: defaultMediaType }];\n    }\n\n    if (byteRange) {\n      headers.Range = DICOMwebClient._buildRangeHeaderFieldValue(byteRange);\n    }\n\n    headers.Accept = DICOMwebClient._buildMultipartAcceptHeaderFieldValue(\n      acceptableMediaTypes,\n      supportedMediaTypes\n    );\n\n    return this._httpGet(url, headers, \"arraybuffer\", progressCallback, withCredentials).then(\n      multipartDecode\n    );\n  }\n\n  /**\n   * Performs an HTTP POST request.\n   *\n   * @param {String} url - Unique resource locator\n   * @param {Object} headers - HTTP header fields\n   * @param {Array} data - Data that should be stored\n   * @param {Function} progressCallback\n   * @private\n   * @returns {Promise} Response\n   */\n  _httpPost(url, headers, data, progressCallback, withCredentials) {\n    return this._httpRequest(url, \"post\", headers, {\n      data,\n      progressCallback,\n      withCredentials\n    });\n  }\n\n  /**\n   * Performs an HTTP POST request with content-type application/dicom+json.\n   *\n   * @param {String} url - Unique resource locator\n   * @param {Object} headers - HTTP header fields\n   * @param {Array} data - Data that should be stored\n   * @param {Function} progressCallback\n   * @private\n   * @returns {Promise} Response\n   */\n  _httpPostApplicationJson(url, data, progressCallback, withCredentials) {\n    const headers = { \"Content-Type\": MEDIATYPES.DICOM_JSON };\n    return this._httpPost(url, headers, data, progressCallback, withCredentials);\n  }\n\n  /**\n   * Parses media type and extracts its type and subtype.\n   *\n   * @param {String} mediaType - HTTP media type (e.g. image/jpeg)\n   * @private\n   * @returns {String[]} Media type and subtype\n   */\n  static _parseMediaType(mediaType) {\n    DICOMwebClient._assertMediaTypeIsValid(mediaType);\n\n    return mediaType.split(\"/\");\n  }\n\n  /**\n   * Builds an accept header field value for HTTP GET request messages.\n   *\n   * @param {Object[]} mediaTypes - Acceptable media types\n   * @param {Object[]} supportedMediaTypes - Supported media types\n   * @return {*}\n   * @private\n   */\n  static _buildAcceptHeaderFieldValue(mediaTypes, supportedMediaTypes) {\n    if (!Array.isArray(mediaTypes)) {\n      throw new Error(\"Acceptable media types must be provided as an Array\");\n    }\n\n    const fieldValueParts = mediaTypes.map(item => {\n      const { mediaType } = item;\n\n      DICOMwebClient._assertMediaTypeIsValid(mediaType);\n      if (!supportedMediaTypes.includes(mediaType)) {\n        throw new Error(\n          `Media type ${mediaType} is not supported for requested resource`\n        );\n      }\n\n      return mediaType;\n    });\n\n    return fieldValueParts.join(\", \");\n  }\n\n  /**\n     * Builds an accept header field value for HTTP GET multipart request\n     messages.\n     *\n     * @param {Object[]} mediaTypes - Acceptable media types\n     * @param {Object[]} supportedMediaTypes - Supported media types\n     * @private\n     */\n  static _buildMultipartAcceptHeaderFieldValue(\n    mediaTypes,\n    supportedMediaTypes\n  ) {\n    if (!Array.isArray(mediaTypes)) {\n      throw new Error(\"Acceptable media types must be provided as an Array\");\n    }\n\n    if (!Array.isArray(supportedMediaTypes) && !isObject(supportedMediaTypes)) {\n      throw new Error(\n        \"Supported media types must be provided as an Array or an Object\"\n      );\n    }\n\n    const fieldValueParts = [];\n\n    mediaTypes.forEach(item => {\n      const { transferSyntaxUID, mediaType } = item;\n      DICOMwebClient._assertMediaTypeIsValid(mediaType);\n      let fieldValue = `multipart/related; type=\"${mediaType}\"`;\n\n      if (isObject(supportedMediaTypes)) {\n        // SupportedMediaTypes is a lookup table that maps Transfer Syntax UID\n        // to one or more Media Types\n        if (!Object.values(supportedMediaTypes).flat(1).includes(mediaType)) {\n          if (!mediaType.endsWith(\"/*\") || !mediaType.endsWith(\"/\")) {\n            throw new Error(\n              `Media type ${mediaType} is not supported for requested resource`\n            );\n          }\n        }\n\n        if (transferSyntaxUID) {\n          if (transferSyntaxUID !== \"*\") {\n            if (!Object.keys(supportedMediaTypes).includes(transferSyntaxUID)) {\n              throw new Error(\n                `Transfer syntax ${transferSyntaxUID} is not supported for requested resource`\n              );\n            }\n\n            const expectedMediaTypes = supportedMediaTypes[transferSyntaxUID];\n\n            if (!expectedMediaTypes.includes(mediaType)) {\n              const actualType = DICOMwebClient._parseMediaType(mediaType)[0];\n              expectedMediaTypes.map(expectedMediaType => {\n                  const expectedType = DICOMwebClient._parseMediaType(\n                    expectedMediaType\n                  )[0];\n                  const haveSameType = actualType === expectedType;\n\n                  if (\n                    haveSameType &&\n                    (mediaType.endsWith(\"/*\") || mediaType.endsWith(\"/\"))\n                  ) {\n                    return;\n                  }\n\n                  throw new Error(\n                    `Transfer syntax ${transferSyntaxUID} is not supported for requested resource`\n                  );\n              })\n            }\n          }\n\n          fieldValue += `; transfer-syntax=${transferSyntaxUID}`;\n        }\n      } else if (\n        Array.isArray(supportedMediaTypes) &&\n        !supportedMediaTypes.includes(mediaType)\n      ) {\n        throw new Error(\n          `Media type ${mediaType} is not supported for requested resource`\n        );\n      }\n\n      fieldValueParts.push(fieldValue);\n    });\n\n    return fieldValueParts.join(\", \");\n  }\n\n  /**\n   * Builds a range header field value for HTTP GET request messages.\n   *\n   * @param {Array} byteRange - Start and end of byte range\n   * @returns {String} Range header field value\n   * @private\n   */\n  static _buildRangeHeaderFieldValue(byteRange = []) {\n    if (byteRange.length === 1) {\n      return `bytes=${byteRange[0]}-`;\n    }\n    if (byteRange.length === 2) {\n      return `bytes=${byteRange[0]}-${byteRange[1]}`;\n    }\n\n    return \"bytes=0-\";\n  }\n\n  /**\n   * Gets types that are shared among acceptable media types.\n   *\n   * @param {Object[]} mediaTypes - Acceptable media types and optionally the UIDs of the\n   corresponding transfer syntaxes\n   * @private\n   * @returns {String[]} Types that are shared among acceptable media types\n   */\n  static _getSharedMediaTypes(mediaTypes) {\n    const types = new Set();\n\n    if (!mediaTypes || !mediaTypes.length) {\n      return types\n    }\n\n    mediaTypes.forEach(item => {\n      const { mediaType } = item;\n      const type = DICOMwebClient._parseMediaType(mediaType)[0];\n      types.add(`${type}/`);\n    });\n\n    return Array.from(types)\n  }\n\n  /**\n   * Gets common type of acceptable media types and asserts that only\n   one type is specified. For example, ``(\"image/jpeg\", \"image/jp2\")``\n   will pass, but ``(\"image/jpeg\", \"video/mpeg2\")`` will raise an\n   exception.\n   *\n   * @param {Object[]} mediaTypes - Acceptable media types and optionally the UIDs of the\n   corresponding transfer syntaxes\n   * @private\n   * @returns {String[]} Common media type\n   */\n  static _getCommonMediaType(mediaTypes) {\n    if (!mediaTypes || !mediaTypes.length) {\n      throw new Error(\"No acceptable media types provided\");\n    }\n\n    const sharedMediaTypes = DICOMwebClient._getSharedMediaTypes(mediaTypes);\n    if (sharedMediaTypes.length === 0) {\n      throw new Error(\"No common acceptable media type could be identified.\");\n    } else if (sharedMediaTypes.length > 1) {\n      throw new Error(\"Acceptable media types must have the same type.\");\n    }\n\n    return sharedMediaTypes[0];\n  }\n\n  /**\n   * Searches for DICOM studies.\n   *\n   * @param {Object} options\n   * @param {Object} [options.queryParams] - HTTP query parameters\n   * @return {Object[]} Study representations (http://dicom.nema.org/medical/dicom/current/output/chtml/part18/sect_6.7.html#table_6.7.1-2)\n   */\n  searchForStudies(options = {}) {\n    console.log(\"search for studies\");\n    let withCredentials = false;\n    let url = `${this.qidoURL}/studies`;\n    if (\"queryParams\" in options) {\n      url += DICOMwebClient._parseQueryParameters(options.queryParams);\n    }\n    if (\"withCredentials\" in options) {\n      if(options.withCredentials) {\n        withCredentials = options.withCredentials;\n      }\n    }\n    return this._httpGetApplicationJson(url, {}, false, withCredentials);\n  }\n\n  /**\n   * Retrieves metadata for a DICOM study.\n   *\n   * @param {Object} options\n   * @param {Object} studyInstanceUID - Study Instance UID\n   * @returns {Object[]} Metadata elements in DICOM JSON format for each instance\n                      belonging to the study\n   */\n  retrieveStudyMetadata(options) {\n    if (!(\"studyInstanceUID\" in options)) {\n      throw new Error(\n        \"Study Instance UID is required for retrieval of study metadata\"\n      );\n    }\n    console.log(`retrieve metadata of study ${options.studyInstanceUID}`);\n    const url = `${this.wadoURL}/studies/${options.studyInstanceUID}/metadata`;\n    let withCredentials = false;\n    if (\"withCredentials\" in options) {\n      if(options.withCredentials) {\n        withCredentials = options.withCredentials;\n      }\n    }\n    return this._httpGetApplicationJson(url, {}, false, withCredentials);\n  }\n\n  /**\n   * Searches for DICOM series.\n   *\n   * @param {Object} options\n   * @param {Object} [options.studyInstanceUID] - Study Instance UID\n   * @param {Object} [options.queryParams] - HTTP query parameters\n   * @returns {Object[]} Series representations (http://dicom.nema.org/medical/dicom/current/output/chtml/part18/sect_6.7.html#table_6.7.1-2a)\n   */\n  searchForSeries(options = {}) {\n    let url = this.qidoURL;\n    if (\"studyInstanceUID\" in options) {\n      console.log(`search series of study ${options.studyInstanceUID}`);\n      url += `/studies/${options.studyInstanceUID}`;\n    }\n    url += \"/series\";\n    if (\"queryParams\" in options) {\n      url += DICOMwebClient._parseQueryParameters(options.queryParams);\n    }\n    let withCredentials = false;\n    if (\"withCredentials\" in options) {\n      if(options.withCredentials) {\n        withCredentials = options.withCredentials;\n      }\n    }\n    return this._httpGetApplicationJson(url, {}, false, withCredentials);\n  }\n\n  /**\n   * Retrieves metadata for a DICOM series.\n   *\n   * @param {Object} options\n   * @param {Object} options.studyInstanceUID - Study Instance UID\n   * @param {Object} options.seriesInstanceUID - Series Instance UID\n   * @returns {Object[]} Metadata elements in DICOM JSON format for each instance\n                      belonging to the series\n   */\n  retrieveSeriesMetadata(options) {\n    if (!(\"studyInstanceUID\" in options)) {\n      throw new Error(\n        \"Study Instance UID is required for retrieval of series metadata\"\n      );\n    }\n    if (!(\"seriesInstanceUID\" in options)) {\n      throw new Error(\n        \"Series Instance UID is required for retrieval of series metadata\"\n      );\n    }\n\n    console.log(`retrieve metadata of series ${options.seriesInstanceUID}`);\n    const url = `${this.wadoURL}/studies/${options.studyInstanceUID}/series/${\n      options.seriesInstanceUID\n    }/metadata`;\n    let withCredentials = false;\n    if (\"withCredentials\" in options) {\n      if(options.withCredentials) {\n        withCredentials = options.withCredentials;\n      }\n    }\n    return this._httpGetApplicationJson(url, {}, false, withCredentials);\n  }\n\n  /**\n   * Searches for DICOM Instances.\n   *\n   * @param {Object} options\n   * @param {Object} [options.studyInstanceUID] - Study Instance UID\n   * @param {Object} [options.seriesInstanceUID] - Series Instance UID\n   * @param {Object} [options.queryParams] - HTTP query parameters\n   * @returns {Object[]} Instance representations (http://dicom.nema.org/medical/dicom/current/output/chtml/part18/sect_6.7.html#table_6.7.1-2b)\n   */\n  searchForInstances(options = {}) {\n    let url = this.qidoURL;\n    let withCredentials = false;\n    if (\"studyInstanceUID\" in options) {\n      url += `/studies/${options.studyInstanceUID}`;\n      if (\"seriesInstanceUID\" in options) {\n        console.log(\n          `search for instances of series ${options.seriesInstanceUID}`\n        );\n        url += `/series/${options.seriesInstanceUID}`;\n      } else {\n        console.log(\n          `search for instances of study ${options.studyInstanceUID}`\n        );\n      }\n    } else {\n      console.log(\"search for instances\");\n    }\n    url += \"/instances\";\n    if (\"queryParams\" in options) {\n      url += DICOMwebClient._parseQueryParameters(options.queryParams);\n    }\n    if (\"withCredentials\" in options) {\n      if(options.withCredentials) {\n        withCredentials = options.withCredentials;\n      }\n    }\n    return this._httpGetApplicationJson(url, {}, false, withCredentials);\n  }\n\n  /** Returns a WADO-URI URL for an instance\n   *\n   * @param {Object} options\n   * @param {Object} options.studyInstanceUID - Study Instance UID\n   * @param {Object} options.seriesInstanceUID - Series Instance UID\n   * @param {Object} options.sopInstanceUID - SOP Instance UID\n   * @returns {String} WADO-URI URL\n   */\n  buildInstanceWadoURIUrl(options) {\n    if (!(\"studyInstanceUID\" in options)) {\n      throw new Error(\"Study Instance UID is required.\");\n    }\n    if (!(\"seriesInstanceUID\" in options)) {\n      throw new Error(\"Series Instance UID is required.\");\n    }\n    if (!(\"sopInstanceUID\" in options)) {\n      throw new Error(\"SOP Instance UID is required.\");\n    }\n\n    const contentType = options.contentType || MEDIATYPES.DICOM;\n    const transferSyntax = options.transferSyntax || \"*\";\n    const params = [];\n\n    params.push(\"requestType=WADO\");\n    params.push(`studyUID=${options.studyInstanceUID}`);\n    params.push(`seriesUID=${options.seriesInstanceUID}`);\n    params.push(`objectUID=${options.sopInstanceUID}`);\n    params.push(`contentType=${contentType}`);\n    params.push(`transferSyntax=${transferSyntax}`);\n\n    const paramString = params.join(\"&\");\n\n    return `${this.wadoURL}?${paramString}`;\n  }\n\n  /**\n   * Retrieves metadata for a DICOM Instance.\n   *\n   * @param {Object} options object\n   * @param {String} options.studyInstanceUID - Study Instance UID\n   * @param {String} options.seriesInstanceUID - Series Instance UID\n   * @param {String} options.sopInstanceUID - SOP Instance UID\n   * @returns {Object} metadata elements in DICOM JSON format\n   */\n  retrieveInstanceMetadata(options) {\n    if (!(\"studyInstanceUID\" in options)) {\n      throw new Error(\n        \"Study Instance UID is required for retrieval of instance metadata\"\n      );\n    }\n    if (!(\"seriesInstanceUID\" in options)) {\n      throw new Error(\n        \"Series Instance UID is required for retrieval of instance metadata\"\n      );\n    }\n    if (!(\"sopInstanceUID\" in options)) {\n      throw new Error(\n        \"SOP Instance UID is required for retrieval of instance metadata\"\n      );\n    }\n    console.log(`retrieve metadata of instance ${options.sopInstanceUID}`);\n    const url = `${this.wadoURL}/studies/${options.studyInstanceUID}/series/${\n      options.seriesInstanceUID\n    }/instances/${options.sopInstanceUID}/metadata`;\n    let withCredentials = false;\n    if (\"withCredentials\" in options) {\n      if(options.withCredentials) {\n        withCredentials = options.withCredentials;\n      }\n    }\n    return this._httpGetApplicationJson(url, {}, false, withCredentials);\n  }\n\n  /**\n   * Retrieves frames for a DICOM Instance.\n   * @param {Object} options options object\n   * @param {String} options.studyInstanceUID - Study Instance UID\n   * @param {String} options.seriesInstanceUID - Series Instance UID\n   * @param {String} options.sopInstanceUID - SOP Instance UID\n   * @param {String} options.frameNumbers - One-based indices of Frame Items\n   * @returns {Array} frame items as byte arrays of the pixel data element\n   */\n  retrieveInstanceFrames(options) {\n    if (!(\"studyInstanceUID\" in options)) {\n      throw new Error(\n        \"Study Instance UID is required for retrieval of instance frames\"\n      );\n    }\n    if (!(\"seriesInstanceUID\" in options)) {\n      throw new Error(\n        \"Series Instance UID is required for retrieval of instance frames\"\n      );\n    }\n    if (!(\"sopInstanceUID\" in options)) {\n      throw new Error(\n        \"SOP Instance UID is required for retrieval of instance frames\"\n      );\n    }\n    if (!(\"frameNumbers\" in options)) {\n      throw new Error(\n        \"frame numbers are required for retrieval of instance frames\"\n      );\n    }\n    console.log(\n      `retrieve frames ${options.frameNumbers.toString()} of instance ${\n        options.sopInstanceUID\n      }`\n    );\n    const url = `${this.wadoURL}/studies/${options.studyInstanceUID}/series/${\n      options.seriesInstanceUID\n    }/instances/${\n      options.sopInstanceUID\n    }/frames/${options.frameNumbers.toString()}`;\n\n    const { mediaTypes } = options;\n    let withCredentials = false;\n    if (\"withCredentials\" in options) {\n      if(options.withCredentials) {\n        withCredentials = options.withCredentials;\n      }\n    }\n\n    let progressCallback = false;\n    if (\"progressCallback\" in options) {\n      progressCallback = options.progressCallback;\n    }\n\n    if (!mediaTypes) {\n      return this._httpGetMultipartApplicationOctetStream(\n        url, false, false, false, progressCallback, withCredentials\n      );\n    }\n\n    const sharedMediaTypes = DICOMwebClient._getSharedMediaTypes(mediaTypes);\n    if (sharedMediaTypes.length > 1) {\n      /**\n       * Enable request of frames that are stored either compressed\n       * (image/* media type) or uncompressed (application/octet-stream\n       * media type).\n       */\n      const supportedMediaTypes = {\n        \"1.2.840.10008.1.2.1\": [\"application/octet-stream\"],\n        \"1.2.840.10008.1.2.5\": [\"image/x-dicom-rle\"],\n        \"1.2.840.10008.1.2.4.50\": [\"image/jpeg\"],\n        \"1.2.840.10008.1.2.4.51\": [\"image/jpeg\"],\n        \"1.2.840.10008.1.2.4.57\": [\"image/jpeg\"],\n        \"1.2.840.10008.1.2.4.70\": [\"image/jpeg\"],\n        \"1.2.840.10008.1.2.4.80\": [\"image/x-jls\", \"image/jls\"],\n        \"1.2.840.10008.1.2.4.81\": [\"image/x-jls\", \"image/jls\"],\n        \"1.2.840.10008.1.2.4.90\": [\"image/jp2\"],\n        \"1.2.840.10008.1.2.4.91\": [\"image/jp2\"],\n        \"1.2.840.10008.1.2.4.92\": [\"image/jpx\"],\n        \"1.2.840.10008.1.2.4.93\": [\"image/jpx\"],\n      }\n\n      const headers = {\n        Accept: DICOMwebClient._buildMultipartAcceptHeaderFieldValue(\n          mediaTypes,\n          supportedMediaTypes\n        )\n      }\n      return this._httpGet(\n        url, headers, \"arraybuffer\", progressCallback, withCredentials\n      ).then(multipartDecode);\n    }\n\n    const commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n\n    if (commonMediaType.startsWith(\"application\")) {\n      return this._httpGetMultipartApplicationOctetStream(\n        url, mediaTypes, false, false, progressCallback, withCredentials\n      );\n    } else if (commonMediaType.startsWith(\"image\")) {\n      return this._httpGetMultipartImage(\n        url, mediaTypes, false, false, false, progressCallback, withCredentials\n      );\n    } else if (commonMediaType.startsWith(\"video\")) {\n      return this._httpGetMultipartVideo(\n        url, mediaTypes, false, false, false, progressCallback, withCredentials\n      );\n    }\n\n    throw new Error(\n      `Media type ${commonMediaType} is not supported for retrieval of frames.`\n    );\n  }\n\n  /**\n   * Retrieves an individual, server-side rendered DICOM Instance.\n   *\n   * @param {Object} options\n   * @param {String} options.studyInstanceUID - Study Instance UID\n   * @param {String} options.seriesInstanceUID - Series Instance UID\n   * @param {String} options.sopInstanceUID - SOP Instance UID\n   * @param {String[]} [options.mediaType] - Acceptable HTTP media types\n   * @param {Object} [options.queryParams] - HTTP query parameters\n   * @returns {ArrayBuffer} Rendered DICOM Instance\n   */\n  retrieveInstanceRendered(options) {\n    if (!(\"studyInstanceUID\" in options)) {\n      throw new Error(\n        \"Study Instance UID is required for retrieval of rendered instance\"\n      );\n    }\n    if (!(\"seriesInstanceUID\" in options)) {\n      throw new Error(\n        \"Series Instance UID is required for retrieval of rendered instance\"\n      );\n    }\n    if (!(\"sopInstanceUID\" in options)) {\n      throw new Error(\n        \"SOP Instance UID is required for retrieval of rendered instance\"\n      );\n    }\n\n    const url = `${this.wadoURL}/studies/${options.studyInstanceUID}/series/${\n      options.seriesInstanceUID\n    }/instances/${options.sopInstanceUID}/rendered`;\n\n    const { mediaTypes, queryParams } = options;\n    const headers = {};\n    let withCredentials = false;\n    if (\"withCredentials\" in options) {\n      if(options.withCredentials) {\n        withCredentials = options.withCredentials;\n      }\n    }\n\n    let progressCallback = false;\n    if (\"progressCallback\" in options) {\n      progressCallback = options.progressCallback;\n    }\n\n    if (!mediaTypes) {\n      const responseType = \"arraybuffer\";\n      if (queryParams) {\n        url += DICOMwebClient._parseQueryParameters(queryParams);\n      }\n      return this._httpGet(url, headers, responseType, progressCallback, withCredentials);\n    }\n\n    const commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n    if (commonMediaType.startsWith(\"image\")) {\n      return this._httpGetImage(\n        url, mediaTypes, queryParams, progressCallback, withCredentials\n      );\n    } else if (commonMediaType.startsWith(\"video\")) {\n      return this._httpGetVideo(\n        url, mediaTypes, queryParams, progressCallback, withCredentials\n      );\n    } else if (commonMediaType.startsWith(\"text\")) {\n      return this._httpGetText(\n        url, mediaTypes, queryParams, progressCallback, withCredentials\n      );\n    } else if (commonMediaType === MEDIATYPES.PDF) {\n      return this._httpGetApplicationPdf(\n        url, queryParams, progressCallback, withCredentials\n      );\n    }\n\n    throw new Error(\n      `Media type ${commonMediaType} is not supported ` +\n      'for retrieval of rendered instance.'\n    );\n  }\n\n  /**\n   * Retrieves a thumbnail of an DICOM Instance.\n   *\n   * @param {Object} options\n   * @param {String} options.studyInstanceUID - Study Instance UID\n   * @param {String} options.seriesInstanceUID - Series Instance UID\n   * @param {String} options.sopInstanceUID - SOP Instance UID\n   * @param {String[]} [options.mediaType] - Acceptable HTTP media types\n   * @param {Object} [options.queryParams] - HTTP query parameters\n   * @returns {ArrayBuffer} Thumbnail\n   */\n  retrieveInstanceThumbnail(options) {\n    if (!(\"studyInstanceUID\" in options)) {\n      throw new Error(\n        \"Study Instance UID is required for retrieval of rendered instance\"\n      );\n    }\n    if (!(\"seriesInstanceUID\" in options)) {\n      throw new Error(\n        \"Series Instance UID is required for retrieval of rendered instance\"\n      );\n    }\n    if (!(\"sopInstanceUID\" in options)) {\n      throw new Error(\n        \"SOP Instance UID is required for retrieval of rendered instance\"\n      );\n    }\n\n    const url = `${this.wadoURL}/studies/${options.studyInstanceUID}/series/${\n      options.seriesInstanceUID\n    }/instances/${options.sopInstanceUID}/thumbnail`;\n\n    const { mediaTypes, queryParams } = options;\n    const headers = {};\n    let withCredentials = false;\n    if (\"withCredentials\" in options) {\n      if(options.withCredentials) {\n        withCredentials = options.withCredentials;\n      }\n    }\n\n    let progressCallback = false;\n    if (\"progressCallback\" in options) {\n      progressCallback = options.progressCallback;\n    }\n\n    if (!mediaTypes) {\n      const responseType = \"arraybuffer\";\n      if (queryParams) {\n        url += DICOMwebClient._parseQueryParameters(queryParams);\n      }\n      return this._httpGet(\n        url, headers, responseType, progressCallback, withCredentials\n      );\n    }\n\n    const commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n    if (commonMediaType.startsWith(\"image\")) {\n      return this._httpGetImage(\n        url, mediaTypes, queryParams, progressCallback, withCredentials\n      );\n    }\n\n    throw new Error(\n      `Media type ${commonMediaType} is not supported ` +\n      'for retrieval of rendered instance.'\n    );\n  }\n\n  /**\n   * Retrieves rendered frames for a DICOM Instance.\n   *\n   * @param {Object} options\n   * @param {String} options.studyInstanceUID - Study Instance UID\n   * @param {String} options.seriesInstanceUID - Series Instance UID\n   * @param {String} options.sopInstanceUID - SOP Instance UID\n   * @param {String} options.frameNumbers - One-based indices of Frame Items\n   * @param {String[]} [options.mediaType] - Acceptable HTTP media types\n   * @param {Object} [options.queryParams] - HTTP query parameters\n   * @returns {ArrayBuffer[]} Rendered Frame Items as byte arrays\n   */\n  retrieveInstanceFramesRendered(options) {\n    if (!(\"studyInstanceUID\" in options)) {\n      throw new Error(\n        \"Study Instance UID is required for retrieval of rendered instance frames\"\n      );\n    }\n    if (!(\"seriesInstanceUID\" in options)) {\n      throw new Error(\n        \"Series Instance UID is required for retrieval of rendered instance frames\"\n      );\n    }\n    if (!(\"sopInstanceUID\" in options)) {\n      throw new Error(\n        \"SOP Instance UID is required for retrieval of rendered instance frames\"\n      );\n    }\n    if (!(\"frameNumbers\" in options)) {\n      throw new Error(\n        \"frame numbers are required for retrieval of rendered instance frames\"\n      );\n    }\n\n    console.debug(\n      `retrieve rendered frames ${options.frameNumbers.toString()} of instance ${\n        options.sopInstanceUID\n      }`\n    );\n    const url = `${this.wadoURL}/studies/${options.studyInstanceUID}/series/${\n      options.seriesInstanceUID\n    }/instances/${\n      options.sopInstanceUID\n    }/frames/${options.frameNumbers.toString()}/rendered`;\n\n    const { mediaTypes, queryParams } = options;\n    const headers = {};\n    let withCredentials = false;\n    if (\"withCredentials\" in options) {\n      if(options.withCredentials) {\n        withCredentials = options.withCredentials;\n      }\n    }\n    let progressCallback = false;\n    if (\"progressCallback\" in options) {\n      progressCallback = options.progressCallback;\n    }\n\n    if (!mediaTypes) {\n      const responseType = \"arraybuffer\";\n      if (queryParams) {\n        url += DICOMwebClient._parseQueryParameters(queryParams);\n      }\n      return this._httpGet(url, headers, responseType, false, withCredentials);\n    }\n\n    const commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n    if (commonMediaType.startsWith(\"image\")) {\n      return this._httpGetImage(\n        url, mediaTypes, queryParams, progressCallback, withCredentials\n      );\n    } else if (commonMediaType.startsWith(\"video\")) {\n      return this._httpGetVideo(\n        url, mediaTypes, queryParams, progressCallback, withCredentials\n      );\n    }\n\n    throw new Error(\n      `Media type ${commonMediaType} is not supported ` +\n      'for retrieval of rendered frame.'\n    );\n  }\n\n  /**\n   * Retrieves thumbnail of frames for a DICOM Instance.\n   *\n   * @param {Object} options\n   * @param {String} options.studyInstanceUID - Study Instance UID\n   * @param {String} options.seriesInstanceUID - Series Instance UID\n   * @param {String} options.sopInstanceUID - SOP Instance UID\n   * @param {String} options.frameNumbers - One-based indices of Frame Items\n   * @param {Object} [options.queryParams] - HTTP query parameters\n   * @returns {ArrayBuffer[]} Rendered Frame Items as byte arrays\n   */\n  retrieveInstanceFramesThumbnail(options) {\n    if (!(\"studyInstanceUID\" in options)) {\n      throw new Error(\n        \"Study Instance UID is required for retrieval of rendered instance frames\"\n      );\n    }\n    if (!(\"seriesInstanceUID\" in options)) {\n      throw new Error(\n        \"Series Instance UID is required for retrieval of rendered instance frames\"\n      );\n    }\n    if (!(\"sopInstanceUID\" in options)) {\n      throw new Error(\n        \"SOP Instance UID is required for retrieval of rendered instance frames\"\n      );\n    }\n    if (!(\"frameNumbers\" in options)) {\n      throw new Error(\n        \"frame numbers are required for retrieval of rendered instance frames\"\n      );\n    }\n\n    console.debug(\n      `retrieve rendered frames ${options.frameNumbers.toString()} of instance ${\n        options.sopInstanceUID\n      }`\n    );\n    const url = `${this.wadoURL}/studies/${options.studyInstanceUID}/series/${\n      options.seriesInstanceUID\n    }/instances/${\n      options.sopInstanceUID\n    }/frames/${options.frameNumbers.toString()}/thumbnail`;\n\n    const { mediaTypes, queryParams } = options;\n    const headers = {};\n    let withCredentials = false;\n    if (\"withCredentials\" in options) {\n      if(options.withCredentials) {\n        withCredentials = options.withCredentials;\n      }\n    }\n\n    let progressCallback = false;\n    if (\"progressCallback\" in options) {\n      progressCallback = options.progressCallback;\n    }\n\n    if (!mediaTypes) {\n      const responseType = \"arraybuffer\";\n      if (queryParams) {\n        url += DICOMwebClient._parseQueryParameters(queryParams);\n      }\n      return this._httpGet(\n        url, headers, responseType, progressCallback, withCredentials\n      );\n    }\n\n    const commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n    if (commonMediaType.startsWith(\"image\")) {\n      return this._httpGetImage(\n        url, mediaTypes, queryParams, progressCallback, withCredentials\n      );\n    }\n\n    throw new Error(\n      `Media type ${commonMediaType} is not supported ` +\n      'for retrieval of rendered frame.'\n    );\n  }\n\n  /**\n   * Retrieves a DICOM Instance.\n   *\n   * @param {Object} options\n   * @param {String} options.studyInstanceUID - Study Instance UID\n   * @param {String} options.seriesInstanceUID - Series Instance UID\n   * @param {String} options.sopInstanceUID - SOP Instance UID\n   * @returns {ArrayBuffer} DICOM Part 10 file as Arraybuffer\n   */\n  retrieveInstance(options) {\n    if (!(\"studyInstanceUID\" in options)) {\n      throw new Error(\"Study Instance UID is required\");\n    }\n    if (!(\"seriesInstanceUID\" in options)) {\n      throw new Error(\"Series Instance UID is required\");\n    }\n    if (!(\"sopInstanceUID\" in options)) {\n      throw new Error(\"SOP Instance UID is required\");\n    }\n    const url = `${this.wadoURL}/studies/${options.studyInstanceUID}/series/${\n      options.seriesInstanceUID\n    }/instances/${options.sopInstanceUID}`;\n\n    const { mediaTypes } = options;\n    let withCredentials = false;\n    if (\"withCredentials\" in options) {\n      if(options.withCredentials) {\n        withCredentials = options.withCredentials;\n      }\n    }\n\n    let progressCallback = false;\n    if (\"progressCallback\" in options) {\n      progressCallback = options.progressCallback;\n    }\n\n    if (!mediaTypes) {\n      return this._httpGetMultipartApplicationDicom(\n        url, false, false, progressCallback, withCredentials\n      ).then(getFirstResult);\n    }\n\n    const commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n    if (commonMediaType === MEDIATYPES.DICOM) {\n      return this._httpGetMultipartApplicationDicom(\n        url, mediaTypes, false, progressCallback, withCredentials\n      ).then(getFirstResult);\n    }\n\n    throw new Error(\n      `Media type ${commonMediaType} is not supported for retrieval of instance.`\n    );\n  }\n\n  /**\n   * Retrieves all DICOM Instances of a Series.\n   *\n   * @param {Object} options\n   * @param {String} options.studyInstanceUID - Study Instance UID\n   * @param {String} options.seriesInstanceUID - Series Instance UID\n   * @returns {ArrayBuffer[]} DICOM Instances\n   */\n  retrieveSeries(options) {\n    if (!(\"studyInstanceUID\" in options)) {\n      throw new Error(\"Study Instance UID is required\");\n    }\n    if (!(\"seriesInstanceUID\" in options)) {\n      throw new Error(\"Series Instance UID is required\");\n    }\n\n    const url = `${this.wadoURL}/studies/${options.studyInstanceUID}/series/${\n      options.seriesInstanceUID\n    }`;\n\n    const { mediaTypes } = options;\n    let withCredentials = false;\n    if (\"withCredentials\" in options) {\n      if(options.withCredentials) {\n        withCredentials = options.withCredentials;\n      }\n    }\n\n    let progressCallback = false;\n    if (\"progressCallback\" in options) {\n      progressCallback = options.progressCallback;\n    }\n\n    if (!mediaTypes) {\n      return this._httpGetMultipartApplicationDicom(\n        url, false, false, progressCallback, withCredentials\n      );\n    }\n\n    const commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n    if (commonMediaType === MEDIATYPES.DICOM) {\n      return this._httpGetMultipartApplicationDicom(\n        url, mediaTypes, false, progressCallback, withCredentials\n      );\n    }\n\n    throw new Error(\n      `Media type ${commonMediaType} is not supported for retrieval of series.`\n    );\n  }\n\n  /**\n   * Retrieves all DICOM Instances of a Study.\n   *\n   * @param {Object} options\n   * @param {String} options.studyInstanceUID - Study Instance UID\n   * @returns {ArrayBuffer[]} DICOM Instances\n   */\n  retrieveStudy(options) {\n    if (!(\"studyInstanceUID\" in options)) {\n      throw new Error(\"Study Instance UID is required\");\n    }\n\n    const url = `${this.wadoURL}/studies/${options.studyInstanceUID}`;\n\n    const { mediaTypes } = options;\n    let withCredentials = false;\n    if (\"withCredentials\" in options) {\n      if(options.withCredentials) {\n        withCredentials = options.withCredentials;\n      }\n    }\n\n    let progressCallback = false;\n    if (\"progressCallback\" in options) {\n      progressCallback = options.progressCallback;\n    }\n\n    if (!mediaTypes) {\n      return this._httpGetMultipartApplicationDicom(\n        url, false, false, progressCallback, withCredentials\n      );\n    }\n\n    const commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n    if (commonMediaType === MEDIATYPES.DICOM) {\n      return this._httpGetMultipartApplicationDicom(\n        url, mediaTypes, false, progressCallback, withCredentials\n      );\n    }\n\n    throw new Error(\n      `Media type ${commonMediaType} is not supported for retrieval of study.`\n    );\n  }\n\n  /**\n   * Retrieves and parses BulkData from a BulkDataURI location.\n   * Decodes the multipart encoded data and returns the resulting data\n   * as an ArrayBuffer.\n   *\n   * See http://dicom.nema.org/medical/dicom/current/output/chtml/part18/sect_6.5.5.html\n   *\n   * @param {Object} options\n   * @param {String} BulkDataURI - URI for retrieval of bulkdata\n   * @returns {Promise<Array>} Bulkdata parts\n   */\n  retrieveBulkData(options) {\n    if (!(\"BulkDataURI\" in options)) {\n      throw new Error(\"BulkDataURI is required.\");\n    }\n\n    const url = options.BulkDataURI;\n    const { mediaTypes, byteRange } = options;\n    let withCredentials = false;\n    if (\"withCredentials\" in options) {\n      if(options.withCredentials) {\n        withCredentials = options.withCredentials;\n      }\n    }\n\n    let progressCallback = false;\n    if (\"progressCallback\" in options) {\n      progressCallback = options.progressCallback;\n    }\n\n    if (!mediaTypes) {\n      return this._httpGetMultipartApplicationOctetStream(\n        url,\n        mediaTypes,\n        byteRange,\n        false, false, withCredentials\n      );\n    }\n\n    const commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n\n    if (commonMediaType === MEDIATYPES.OCTET_STREAM) {\n      return this._httpGetMultipartApplicationOctetStream(\n        url,\n        mediaTypes,\n        byteRange,\n        false, progressCallback, withCredentials\n      );\n    } else if (commonMediaType.startsWith(\"image\")) {\n      return this._httpGetMultipartImage(\n        url, mediaTypes, byteRange, false, false, progressCallback, withCredentials\n      );\n    }\n\n    throw new Error(\n      `Media type ${commonMediaType} is not supported for retrieval of bulk data.`\n    );\n  }\n\n  /**\n   * Stores DICOM Instances.\n   *\n   * @param {Object} options\n   * @param {ArrayBuffer[]} options.datasets - DICOM Instances in PS3.10 format\n   * @param {String} [options.studyInstanceUID] - Study Instance UID\n   * @returns {Promise} Response message\n   */\n  storeInstances(options) {\n    if (!(\"datasets\" in options)) {\n      throw new Error(\"datasets are required for storing\");\n    }\n\n    let url = `${this.stowURL}/studies`;\n    if (\"studyInstanceUID\" in options) {\n      url += `/${options.studyInstanceUID}`;\n    }\n\n    const { data, boundary } = multipartEncode(options.datasets);\n    const headers = {\n      \"Content-Type\": `multipart/related; type=\"application/dicom\"; boundary=\"${boundary}\"`\n    };\n    let withCredentials = false;\n    if (\"withCredentials\" in options) {\n      if(options.withCredentials) {\n        withCredentials = options.withCredentials;\n      }\n    }\n    return this._httpPost(\n      url, headers, data, options.progressCallback, withCredentials\n    );\n  }\n}\n\nexport { DICOMwebClient };\nexport default DICOMwebClient;\n","function findSubstring(str, before, after) {\n  const beforeIndex = str.lastIndexOf(before) + before.length;\n  if (beforeIndex < before.length) {\n    return null;\n  }\n  if (after !== undefined) {\n    const afterIndex = str.lastIndexOf(after);\n    if (afterIndex < 0) {\n      return null;\n    }\n    return str.substring(beforeIndex, afterIndex);\n  }\n  return str.substring(beforeIndex);\n}\n\nfunction getStudyInstanceUIDFromUri(uri) {\n  let uid = findSubstring(uri, \"studies/\", \"/series\");\n  if (!uid) {\n    uid = findSubstring(uri, \"studies/\");\n  }\n  if (!uid) {\n    console.debug(\n      `Study Instance UID could not be dertermined from URI \"${uri}\"`\n    );\n  }\n  return uid;\n}\n\nfunction getSeriesInstanceUIDFromUri(uri) {\n  let uid = findSubstring(uri, \"series/\", \"/instances\");\n  if (!uid) {\n    uid = findSubstring(uri, \"series/\");\n  }\n  if (!uid) {\n    console.debug(\n      `Series Instance UID could not be dertermined from URI \"${uri}\"`\n    );\n  }\n  return uid;\n}\n\nfunction getSOPInstanceUIDFromUri(uri) {\n  let uid = findSubstring(uri, \"/instances/\", \"/frames\");\n  if (!uid) {\n    uid = findSubstring(uri, \"/instances/\", \"/metadata\");\n  }\n  if (!uid) {\n    uid = findSubstring(uri, \"/instances/\");\n  }\n  if (!uid) {\n    console.debug(`SOP Instance UID could not be dertermined from URI\"${uri}\"`);\n  }\n  return uid;\n}\n\nfunction getFrameNumbersFromUri(uri) {\n  let numbers = findSubstring(uri, \"/frames/\", \"/rendered\");\n  if (!numbers) {\n    numbers = findSubstring(uri, \"/frames/\");\n  }\n  if (numbers === undefined) {\n    console.debug(`Frames Numbers could not be dertermined from URI\"${uri}\"`);\n  }\n  return numbers.split(\",\");\n}\n\nexport {\n  getStudyInstanceUIDFromUri,\n  getSeriesInstanceUIDFromUri,\n  getSOPInstanceUIDFromUri,\n  getFrameNumbersFromUri\n};\n","export default \"0.5.2\";\n","import { DICOMwebClient } from \"./api.js\";\nimport {\n  getStudyInstanceUIDFromUri,\n  getSeriesInstanceUIDFromUri,\n  getSOPInstanceUIDFromUri,\n  getFrameNumbersFromUri\n} from \"./utils.js\";\n\nconst api = {\n  DICOMwebClient\n};\nconst utils = {\n  getStudyInstanceUIDFromUri,\n  getSeriesInstanceUIDFromUri,\n  getSOPInstanceUIDFromUri,\n  getFrameNumbersFromUri\n};\n\nexport { default as version } from \"./version.js\";\n\nexport { api, utils };\n"],"names":["uint8ArrayToString","arr","offset","limit","itemLimit","length","str","i","String","fromCharCode","stringToUint8Array","Uint8Array","j","charCodeAt","identifyBoundary","header","parts","split","substr","containsToken","message","token","index","findToken","maxSearchLength","searchLength","Math","min","guid","s4","floor","random","toString","substring","multipartEncode","datasets","boundary","contentType","contentTypeString","footer","headerArray","footerArray","headerLength","footerLength","contentArrays","map","datasetBuffer","contentArray","contentLength","multipartArray","set","position","forEach","data","buffer","multipartDecode","response","separator","headerIndex","Error","boundaryString","boundaryLength","components","boundaryIndex","headerTokenIndex","spacingLength","slice","push","isObject","obj","isEmptyObject","Object","keys","constructor","areValidRequestHooks","requestHooks","isValid","Array","isArray","every","requestHook","console","warn","getFirstResult","result","MEDIATYPES","DICOM","DICOM_JSON","OCTET_STREAM","PDF","JPEG","PNG","DICOMwebClient","options","baseURL","url","error","username","password","log","qidoURLPrefix","qidoURL","wadoURLPrefix","wadoURL","stowURLPrefix","stowURL","headers","errorInterceptor","verbose","method","Promise","resolve","reject","request","XMLHttpRequest","open","responseType","key","setRequestHeader","userHeaders","onloadstart","onloadend","onreadystatechange","readyState","status","progressCallback","onprogress","assign","metadata","pipeRequestHooks","functions","args","reduce","fn","pipedRequest","withCredentials","send","_httpRequest","params","urlWithQueryParams","_parseQueryParameters","Accept","_httpGet","mediaTypes","supportedMediaTypes","acceptHeaderFieldValue","_buildAcceptHeaderFieldValue","byteRange","rendered","Range","_buildRangeHeaderFieldValue","_buildMultipartAcceptHeaderFieldValue","then","defaultMediaType","acceptableMediaTypes","mediaType","_httpPost","queryParams","_httpGetApplicationJson","studyInstanceUID","seriesInstanceUID","transferSyntax","sopInstanceUID","paramString","join","frameNumbers","_httpGetMultipartApplicationOctetStream","sharedMediaTypes","_getSharedMediaTypes","commonMediaType","_getCommonMediaType","startsWith","_httpGetMultipartImage","_httpGetMultipartVideo","_httpGetImage","_httpGetVideo","_httpGetText","_httpGetApplicationPdf","debug","_httpGetMultipartApplicationDicom","BulkDataURI","queryString","encodeURIComponent","sepIndex","indexOf","mediaTypeType","types","includes","_assertMediaTypeIsValid","fieldValueParts","item","transferSyntaxUID","fieldValue","values","flat","endsWith","expectedMediaTypes","actualType","_parseMediaType","expectedMediaType","expectedType","haveSameType","Set","type","add","from","findSubstring","before","after","beforeIndex","lastIndexOf","undefined","afterIndex","getStudyInstanceUIDFromUri","uri","uid","getSeriesInstanceUIDFromUri","getSOPInstanceUIDFromUri","getFrameNumbersFromUri","numbers","api","utils"],"mappings":"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"}